{% extends "base.html" %}

{% block title %}Sign in - Speech Practice Coach{% endblock %}

{% block head_extra %}
<style>
  .bubble-grid {
    position: absolute;
    inset: 0;
    margin: 0;
    padding: 0;
    list-style: none;
    overflow: hidden;
    pointer-events: none;
    z-index: 0;
  }

  .bubble-grid .bubble {
    position: absolute;
    bottom: -4rem;
    opacity: 0;
    animation-name: bubble-rise;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    transform: translate(-50%, 0);
    box-shadow: 0 0 12px rgba(99, 102, 241, 0.35);
  }

  @keyframes bubble-rise {
    0% {
      transform: translate(-50%, 0) scale(0.75);
      opacity: 0;
    }
    15% {
      opacity: 0.75;
    }
    100% {
      transform: translate(-50%, -120vh) scale(1.05);
      opacity: 0;
    }
  }
</style>
{% endblock %}

{% block page_wrapper %}
<div class="relative min-h-[calc(100vh-80px)] overflow-hidden px-4 py-16">
  <div aria-hidden="true" class="pointer-events-none absolute inset-0">
    <ul class="bubble-grid">
      <li class="bubble" style="left:5%;width:36px;height:36px;animation-delay:-14s;animation-duration:24s;background:rgba(99,102,241,0.55);"></li>
      <li class="bubble" style="left:18%;width:28px;height:28px;animation-delay:6s;animation-duration:22s;background:rgba(139,92,246,0.45);"></li>
      <li class="bubble" style="left:27%;width:42px;height:42px;animation-delay:-9s;animation-duration:26s;background:rgba(14,165,233,0.5);"></li>
      <li class="bubble" style="left:38%;width:24px;height:24px;animation-delay:3s;animation-duration:19s;background:rgba(16,185,129,0.5);"></li>
      <li class="bubble" style="left:46%;width:30px;height:30px;animation-delay:-3s;animation-duration:21s;background:rgba(139,92,246,0.4);"></li>
      <li class="bubble" style="left:58%;width:40px;height:40px;animation-delay:8s;animation-duration:24s;background:rgba(99,102,241,0.5);"></li>
      <li class="bubble" style="left:67%;width:22px;height:22px;animation-delay:-6s;animation-duration:18s;background:rgba(16,185,129,0.45);"></li>
      <li class="bubble" style="left:74%;width:36px;height:36px;animation-delay:4s;animation-duration:25s;background:rgba(14,165,233,0.48);"></li>
      <li class="bubble" style="left:83%;width:26px;height:26px;animation-delay:-12s;animation-duration:20s;background:rgba(139,92,246,0.5);"></li>
      <li class="bubble" style="left:92%;width:32px;height:32px;animation-delay:11s;animation-duration:23s;background:rgba(99,102,241,0.46);"></li>
      <li class="bubble" style="left:12%;width:24px;height:24px;animation-delay:7s;animation-duration:19s;background:rgba(16,185,129,0.42);"></li>
      <li class="bubble" style="left:32%;width:34px;height:34px;animation-delay:-15s;animation-duration:27s;background:rgba(139,92,246,0.5);"></li>
      <li class="bubble" style="left:44%;width:20px;height:20px;animation-delay:5s;animation-duration:17s;background:rgba(99,102,241,0.45);"></li>
      <li class="bubble" style="left:52%;width:38px;height:38px;animation-delay:-10s;animation-duration:26s;background:rgba(14,165,233,0.5);"></li>
      <li class="bubble" style="left:63%;width:24px;height:24px;animation-delay:2s;animation-duration:21s;background:rgba(16,185,129,0.48);"></li>
      <li class="bubble" style="left:71%;width:28px;height:28px;animation-delay:-4s;animation-duration:22s;background:rgba(139,92,246,0.45);"></li>
      <li class="bubble" style="left:79%;width:20px;height:20px;animation-delay:9s;animation-duration:18s;background:rgba(99,102,241,0.4);"></li>
      <li class="bubble" style="left:87%;width:36px;height:36px;animation-delay:-8s;animation-duration:25s;background:rgba(14,165,233,0.48);"></li>
      <li class="bubble" style="left:95%;width:26px;height:26px;animation-delay:12s;animation-duration:20s;background:rgba(16,185,129,0.45);"></li>
      <li class="bubble" style="left:8%;width:22px;height:22px;animation-delay:-11s;animation-duration:23s;background:rgba(139,92,246,0.5);"></li>
    </ul>
    <div class="absolute -top-32 -left-24 h-80 w-80 rounded-full bg-indigo-500/25 blur-3xl"></div>
    <div class="absolute bottom-[-6rem] right-[-4rem] h-96 w-96 rounded-full bg-emerald-400/20 blur-3xl"></div>
  </div>
  <div class="relative z-10 flex min-h-[60vh] items-center justify-center">
    <main class="w-full max-w-md">
      <section class="rounded-3xl border border-white/10 bg-white/10 p-8 shadow-glow backdrop-blur-xl">
        <div class="mb-8 text-center">
          <h1 class="text-3xl font-semibold tracking-tight text-white">Speech Practice Coach</h1>
          <p class="mt-3 text-sm text-slate-200/80">Log in to continue your coaching journey.</p>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% set alert_styles = {
          'danger': 'border-rose-400/60 bg-rose-500/10 text-rose-100',
          'success': 'border-emerald-400/60 bg-emerald-500/10 text-emerald-100',
          'info': 'border-sky-400/60 bg-sky-500/10 text-sky-100'
        } %}
        <div class="mb-6 space-y-3">
          {% for category, message in messages %}
          {% set level = 'danger' if category == 'error' else 'success' if category == 'success' else 'info' %}
          <div class="flex items-start justify-between gap-4 rounded-xl border px-4 py-3 text-sm {{ alert_styles[level] }}">
            <span>{{ message }}</span>
            <button type="button" class="text-lg leading-none text-white/70 transition hover:text-white" onclick="this.parentElement.remove()">&times;</button>
          </div>
          {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        <form method="post" action="{{ url_for('login') }}" class="space-y-6" novalidate>
          <input type="hidden" name="next" value="{{ next_url }}">

          <div class="space-y-2">
            <label for="email" class="text-sm font-medium text-slate-100">Email</label>
            <input id="email" name="email" type="email" required autocomplete="email" value="{{ request.form.get('email', '') }}" autofocus class="w-full rounded-xl border border-white/20 bg-white/10 px-4 py-3 text-base text-white placeholder:text-slate-300 focus:border-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-300/60">
          </div>

          <div class="space-y-2">
            <label for="password" class="text-sm font-medium text-slate-100">Password</label>
            <input id="password" name="password" type="password" required autocomplete="current-password" class="w-full rounded-xl border border-white/20 bg-white/10 px-4 py-3 text-base text-white placeholder:text-slate-300 focus:border-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-300/60">
          </div>

          <div class="flex flex-col gap-3 sm:flex-row">
            <button type="submit" class="inline-flex w-full items-center justify-center rounded-xl bg-indigo-500 px-4 py-3 text-base font-semibold text-white transition hover:bg-indigo-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-200 sm:w-auto">Log in</button>
            <a class="inline-flex w-full items-center justify-center rounded-xl bg-emerald-500 px-4 py-3 text-base font-semibold text-white transition hover:bg-emerald-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-200 sm:w-auto" href="{{ url_for('register', next=next_url) }}">Create an account</a>
          </div>
        </form>

        <p class="mt-8 text-center text-xs text-slate-200/80">Forgot your password? Contact your coach to reset it.</p>
      </section>
    </main>
  </div>
</div>
{% endblock %}
